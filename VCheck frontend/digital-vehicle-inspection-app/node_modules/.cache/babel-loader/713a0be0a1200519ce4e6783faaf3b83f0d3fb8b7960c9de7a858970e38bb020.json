{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { getInspectionHistory } from '../../api';\nimport './InspectionHistory.css';\nconst InspectionHistory = () => {\n  _s();\n  const [apiHistory, setApiHistory] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [searchTerm, setSearchTerm] = useState('');\n\n  // Get local scan history\n  const [localScanHistory, setLocalScanHistory] = useState([]);\n  useEffect(() => {\n    const history = localStorage.getItem('scanHistory');\n    if (history) {\n      setLocalScanHistory(JSON.parse(history));\n    }\n  }, []);\n  useEffect(() => {\n    const loadInspectionHistory = async () => {\n      try {\n        const userData = JSON.parse(localStorage.getItem('user') || '{}');\n        const inspectorId = userData.id || userData._id;\n        if (!inspectorId) throw new Error('Inspector ID not found');\n        const data = await getInspectionHistory(inspectorId);\n        const mappedApiHistory = data.map(item => {\n          var _ref, _item$id, _item$date, _ref2, _item$vehiclePlate, _ref3, _item$inspectorName, _item$inspector, _ref4, _item$report, _item$status;\n          return {\n            id: (_ref = (_item$id = item.id) !== null && _item$id !== void 0 ? _item$id : item._id) !== null && _ref !== void 0 ? _ref : '',\n            date: new Date((_item$date = item.date) !== null && _item$date !== void 0 ? _item$date : item.createdAt).toLocaleString(),\n            vehiclePlate: (_ref2 = (_item$vehiclePlate = item.vehiclePlate) !== null && _item$vehiclePlate !== void 0 ? _item$vehiclePlate : item.plate) !== null && _ref2 !== void 0 ? _ref2 : '',\n            inspectorName: (_ref3 = (_item$inspectorName = item.inspectorName) !== null && _item$inspectorName !== void 0 ? _item$inspectorName : (_item$inspector = item.inspector) === null || _item$inspector === void 0 ? void 0 : _item$inspector.name) !== null && _ref3 !== void 0 ? _ref3 : '',\n            report: (_ref4 = (_item$report = item.report) !== null && _item$report !== void 0 ? _item$report : item.reportText) !== null && _ref4 !== void 0 ? _ref4 : '',\n            status: (_item$status = item.status) !== null && _item$status !== void 0 ? _item$status : 'clean'\n          };\n        });\n        setApiHistory(mappedApiHistory);\n      } catch (err) {\n        console.error('Error loading history:', err);\n        setError(err instanceof Error ? err.message : 'Failed to load inspection history');\n      } finally {\n        setLoading(false);\n      }\n    };\n    loadInspectionHistory();\n  }, []);\n\n  // Combine API history with local scans\n  const combinedHistory = [...apiHistory, ...localScanHistory.map(scan => ({\n    id: scan.id,\n    date: new Date(scan.timestamp).toLocaleString(),\n    vehiclePlate: scan.plateNumber || 'N/A',\n    inspectorName: 'You',\n    report: scan.message,\n    status: scan.status\n  }))].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n  const filteredHistory = combinedHistory.filter(inspection => inspection.vehiclePlate.toLowerCase().includes(searchTerm.toLowerCase()) || inspection.report.toLowerCase().includes(searchTerm.toLowerCase()) || inspection.status.toLowerCase().includes(searchTerm.toLowerCase()));\n\n  // ... rest of your component remains the same ...\n};\n_s(InspectionHistory, \"u241vfkzSnc/Nw/OosdE4VOQXYA=\");\n_c = InspectionHistory;\nexport default InspectionHistory;\nvar _c;\n$RefreshReg$(_c, \"InspectionHistory\");","map":{"version":3,"names":["useEffect","useState","getInspectionHistory","InspectionHistory","_s","apiHistory","setApiHistory","loading","setLoading","error","setError","searchTerm","setSearchTerm","localScanHistory","setLocalScanHistory","history","localStorage","getItem","JSON","parse","loadInspectionHistory","userData","inspectorId","id","_id","Error","data","mappedApiHistory","map","item","_ref","_item$id","_item$date","_ref2","_item$vehiclePlate","_ref3","_item$inspectorName","_item$inspector","_ref4","_item$report","_item$status","date","Date","createdAt","toLocaleString","vehiclePlate","plate","inspectorName","inspector","name","report","reportText","status","err","console","message","combinedHistory","scan","timestamp","plateNumber","sort","a","b","getTime","filteredHistory","filter","inspection","toLowerCase","includes","_c","$RefreshReg$"],"sources":["C:/Users/Semicolon/Desktop/VCheck2/digital-vehicle-inspection-app/src/components/Inspector/InspectionHistory.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { getInspectionHistory } from '../../api';\nimport './InspectionHistory.css';\n\ninterface Inspection {\n    id: string;\n    date: string;\n    vehiclePlate: string;\n    inspectorName: string;\n    report: string;\n    status: 'clean' | 'violation' | 'verified' | 'rejected';\n}\n\nconst InspectionHistory: React.FC = () => {\n    const [apiHistory, setApiHistory] = useState<Inspection[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [searchTerm, setSearchTerm] = useState('');\n\n    // Get local scan history\n    const [localScanHistory, setLocalScanHistory] = useState<any[]>([]);\n    \n    useEffect(() => {\n        const history = localStorage.getItem('scanHistory');\n        if (history) {\n            setLocalScanHistory(JSON.parse(history));\n        }\n    }, []);\n\n    useEffect(() => {\n        const loadInspectionHistory = async () => {\n            try {\n                const userData = JSON.parse(localStorage.getItem('user') || '{}');\n                const inspectorId = userData.id || userData._id;\n                \n                if (!inspectorId) throw new Error('Inspector ID not found');\n\n                const data = await getInspectionHistory(inspectorId);\n                \n                const mappedApiHistory: Inspection[] = data.map((item: any) => ({\n                    id: item.id ?? item._id ?? '',\n                    date: new Date(item.date ?? item.createdAt).toLocaleString(),\n                    vehiclePlate: item.vehiclePlate ?? item.plate ?? '',\n                    inspectorName: item.inspectorName ?? item.inspector?.name ?? '',\n                    report: item.report ?? item.reportText ?? '',\n                    status: item.status ?? 'clean'\n                }));\n\n                setApiHistory(mappedApiHistory);\n            } catch (err) {\n                console.error('Error loading history:', err);\n                setError(err instanceof Error ? err.message : 'Failed to load inspection history');\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        loadInspectionHistory();\n    }, []);\n\n    // Combine API history with local scans\n    const combinedHistory = [\n        ...apiHistory,\n        ...localScanHistory.map(scan => ({\n            id: scan.id,\n            date: new Date(scan.timestamp).toLocaleString(),\n            vehiclePlate: scan.plateNumber || 'N/A',\n            inspectorName: 'You',\n            report: scan.message,\n            status: scan.status\n        }))\n    ].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n\n    const filteredHistory = combinedHistory.filter(inspection =>\n        inspection.vehiclePlate.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        inspection.report.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        inspection.status.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n\n    // ... rest of your component remains the same ...\n};\n\nexport default InspectionHistory;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}